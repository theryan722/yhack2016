<html>
    <head>
       <link rel="stylesheet" type="text/css" href="css/materialize.css">
        <link rel="stylesheet" type="text/css" href="css/materialize.min.css">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
        <script src="js/dropmenu.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Open+Sans|Open+Sans+Condensed:300" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="css/dropmenu.css">
        <link rel="stylesheet" type="text/css" href="css/regularPages.css">
        <style>
           
            body {
                margin-top: 10%;
            }
            
        </style>
    </head>
    
    <body> 
          <nav> <a id="resp-menu" href="#"><img src="images/menu.png" width="50px"></a>
          <ul class="menu">
              <li><a  href="index.html">Home</a></li>
              <li><a  href="login.html">Login</a></li>
              <li><a  href="signup.html">Sign Up</a></li>
              <li><a  href="fulfill.html">Fulfill</a></li>
              <li><a  href="request.html">Request</a></li>
              <li><a  href="sponsor.html">Sponsor</a></li>
              <li><a  href="about.html">About</a></li>
               
          </ul>
        </nav>
        
        <h1>Profile</h1>
        <form>
            <br>
          <div id="p_name">Name: Ruby </div>
          <div id="p_email"></div>
          <div id="p_address"></div>
          <div id="p_radius"></div>
          <h2>Financial</h2>
          <div id="p_balance"></div>
          <div id="p_budget"></div>
          <div id="p_remain"></div>
        </form>
        
    </body>

    <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script> 
    <script>
    $(document).ready(function(){ 
        var touch 	= $('#resp-menu');
        var menu 	= $('.menu');
        $(touch).on('click', function(e) {
            e.preventDefault();
            menu.slideToggle();
        });
    });
    </script>
    <script type="text/javascript">
      function getCookie(name) {
  				var value = "; " + document.cookie;
  				var parts = value.split("; " + name + "=");
  				if (parts.length == 2) return parts.pop().split(";").shift();
      }
       
      function callUserInfo(resp){
        console.log(resp);
        var temp = JSON.parse(resp);
        setUserInfo(temp['name'], temp['email'], temp['address'], temp['radius'], temp['balance'], temp['budget']);
      }
      
      function httpGetAsync(theUrl, callback) {
        	var xmlHttp = new XMLHttpRequest();
          xmlHttp.onreadystatechange = function() {
          if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
          	callback(xmlHttp.responseText);
        	}
          xmlHttp.open("GET", theUrl, true);
        	xmlHttp.send(null);
      }
      
      function setUserInfo(pname, pemail, paddress, pradius, pbalance, pbudget) {
        document.getElementById('p_name').innerHTML = "<b>Name: </b>" + pname;
        document.getElementById('p_email').innerHTML = "<b>Email: </b>" + pemail;
        document.getElementById('p_address').innerHTML = "<b>Address: </b>" + paddress;
        document.getElementById('p_radius').innerHTML = "<b>Max Radius: </b>" + pradius;
        document.getElementById('p_balance').innerHTML = "<b>Current Balance: </b>" + pbalance;
        document.getElementById('p_budget').innerHTML = "<b>Goal: </b>" + pbudget;
        document.getElementById('p_remain').innerHTML = "<b>Amount needed to reach goal: </b>" + (pbudget - pbalance);
      }
      (function() {
       httpGetAsync("http://yalecodeathon2016.000webhostapp.com/api/user.php?action=get&email="+getCookie("email"), callUserInfo);
      })();
</script>
</html>
